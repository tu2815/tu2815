Sub importWord

Dim xObjDoc As Object

Dim xWdApp As Object

Dim xWdName As Variant

Dim wb As Workbook

Dim sh As Worksheet

Dim dsh As String

Dim lr, xRPP

Application.ScreenUpdating = False

Application.DisplayAlerts = False

xWdName = Application.GetOpenFilename("Word file(*.doc;*.docx) ,*.doc;*.docx", , "Kutools - Please select")

If xWdName = False Then Exit Sub

Application.ScreenUpdating = False

Set xWb = Application.ActiveWorkbook

Set sh = xWb.Worksheets.Add

Set xWdApp = CreateObject("Word.Application")

xWdApp.ScreenUpdating = False

xWdApp.DisplayAlerts = False

Set xObjDoc = xWdApp.Documents.Open(Filename:=xWdName, ReadOnly:=True)

xObjDoc.Activate

lr = xObjDoc.Paragraphs.Count

Set xRPP = xObjDoc.Range(Start:=xObjDoc.Paragraphs(1).Range.Start, End:=xObjDoc.Paragraphs(lr).Range.End)

xRPP.Select

On Error Resume Next

xWdApp.Selection.Copy

dsh = xObjDoc.Name

dsh = Replace(dsh, ":", "_")

dsh = Replace(dsh, "\", "_")

dsh = Replace(dsh, "/", "_")

dsh = Replace(dsh, "?", "_")

dsh = Replace(dsh, "*", "_")

dsh = Replace(dsh, "[", "_")

dsh = Replace(dsh, "]", "_")

If Len(dsh) > 31 Then

    dsh = Left(dsh, 31)

End If

sh.Name = dsh

sh.Range("A1").Select

sh.Paste

xObjDoc.Close

Set xObjDoc = Nothing

xWdApp.DisplayAlerts = True

xWdApp.ScreenUpdating = True

xWdApp.Quit (wdDoNotSaveChanges)

Application.DisplayAlerts = True

Application.ScreenUpdating = True

sh.Columns("A").ColumnWidth = 80

sh.Columns("B").Delete

sh.Cells.EntireRow.AutoFit

End Sub

Sub LietKeFileTrongThuMuc()

    Dim folder_Path As String

    Dim FileName As String

    Dim i As Integer

    FileName = Dir(folder_Path, vbDirectory)

    folder_Path = ThisWorkbook.Sheets("0").Range("C4").Value

    If Right(folder_Path, 1) <> "\" Then folder_Path = folder_Path & "\"

FileName = Dir(folder_Path, vbDirectory)

Do While FileName <> ""

    ws.Range("A1").Value = "List file in folder"

FileName = Dir(folder_Path, vbDirectory)

i = 2
    Do While Len(FileName) > 0

        ws.Cells(i, 1).Value = FileName

        FileName = Dir

        i = i + 1

    Loop

End Sub
